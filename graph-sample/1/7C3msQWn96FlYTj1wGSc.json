{
  "routines": [
  {
    "tag":"sub_10001000",
    "label":"sub_10001000",
    "type":"idapro",
    "callees":[],
    "blocks":[
      {
        "tag":"sub_10001000",
        "label":"sub_10001000",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"mov     eax, 1" },
          { "str":"retn    0Ch" }
        ],
        "callees":[]
      }
    ]
  },{
    "tag":"MyPhotoEncodeEX",
    "label":"MyPhotoEncodeEX",
    "type":"user",
    "callees":[
      { "tag":"MMTCMEncodeEX" }
    ],
    "blocks":[
      {
        "tag":"MyPhotoEncodeEX",
        "label":"MyPhotoEncodeEX",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"mov     eax, [esp+arg_20]" },
          { "str":"mov     ecx, [esp+arg_1C]" },
          { "str":"push    eax" },
          { "str":"push    ecx" },
          { "str":"lea     edx, [esp+8+arg_0]" },
          { "str":"push    edx" },
          { "str":"call    MMTCMEncodeEX" },
          { "str":"add     esp, 0Ch" },
          { "str":"retn" }
        ],
        "callees":[
          { "tag":"MMTCMEncodeEX" }
        ]
      }
    ]
  },{
    "tag":"TestCode",
    "label":"TestCode",
    "type":"user",
    "callees":[],
    "blocks":[
      {
        "tag":"TestCode",
        "label":"TestCode",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"xor     eax, eax" },
          { "str":"retn" }
        ],
        "callees":[]
      }
    ]
  },{
    "tag":"rtn_0",
    "label":"rtn_0",
    "type":"ours",
    "callees":[
      { "tag":"ds__encode_pointer" },
      { "tag":"sub_100015AE" },
      { "tag":"sub_100015C5" }
    ],
    "blocks":[
      {
        "tag":"blk_0",
        "label":"blk_0",
        "out_true":"loc_10001075",
        "out_false":"label_1",
        "last_inst":"jnz",
        "instructions":[
          { "str":"mov     esi, eax" },
          { "str":"push    esi" },
          { "str":"call    ds:_encode_pointer" },
          { "str":"pop     ecx" },
          { "str":"pop     ecx" },
          { "str":"mov     dword_10003358, eax" },
          { "str":"mov     dword_10003354, eax" },
          { "str":"test    esi, esi" },
          { "str":"jnz     short loc_10001075" }
        ],
        "callees":[
          { "tag":"ds__encode_pointer" }
        ]
      },
{
        "tag":"label_1",
        "label":"label_1",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"xor     eax, eax" },
          { "str":"inc     eax" },
          { "str":"pop     esi" },
          { "str":"retn" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001075",
        "label":"loc_10001075",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"and     dword ptr [esi], 0" },
          { "str":"call    sub_100015C5" },
          { "str":"push    offset byte_100015EB" },
          { "str":"call    sub_100015AE" },
          { "str":"mov     dword ptr [esp], offset sub_100014FD" },
          { "str":"call    sub_100015AE" },
          { "str":"pop     ecx" },
          { "str":"xor     eax, eax" },
          { "str":"pop     esi" },
          { "str":"retn" }
        ],
        "callees":[
          { "tag":"sub_100015AE" },
          { "tag":"sub_100015C5" }
        ]
      }
    ]
  },{
    "tag":"sub_10001098",
    "label":"sub_10001098",
    "type":"idapro",
    "callees":[
      { "tag":"_ebp_var_8_" },
      { "tag":"_amsg_exit" },
      { "tag":"_initterm" },
      { "tag":"_initterm_e" },
      { "tag":"ds_InterlockedExchange" },
      { "tag":"ds_Sleep" },
      { "tag":"ds__encoded_null" },
      { "tag":"ds_free" },
      { "tag":"dword_1000335C" },
      { "tag":"esi" },
      { "tag":"sub_100016B0" }
    ],
    "blocks":[
      {
        "tag":"sub_10001098",
        "label":"sub_10001098",
        "out_true":"loc_100010B4",
        "out_false":"label_2",
        "last_inst":"jnz",
        "instructions":[
          { "str":"mov     edi, edi" },
          { "str":"push    ebp" },
          { "str":"mov     ebp, esp" },
          { "str":"push    ecx" },
          { "str":"push    ecx" },
          { "str":"xor     eax, eax" },
          { "str":"cmp     [ebp+Memory], eax" },
          { "str":"jnz     short loc_100010B4" }
        ],
        "callees":[]
      },
{
        "tag":"label_2",
        "label":"label_2",
        "out_true":"loc_100010EA",
        "out_false":"label_3",
        "last_inst":"jl",
        "instructions":[
          { "str":"cmp     dword_10003010, eax" },
          { "str":"jle     short loc_100010EA" }
        ],
        "callees":[]
      },
{
        "tag":"label_3",
        "label":"label_3",
        "out_true":"loc_100010B4",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"dec     dword_10003010" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100010B4",
        "label":"loc_100010B4",
        "out_true":"loc_100011A3",
        "out_false":"label_4",
        "last_inst":"jnz",
        "instructions":[
          { "str":"cmp     [ebp+Memory], 1" },
          { "str":"mov     ecx, ds:_adjust_fdiv" },
          { "str":"mov     ecx, [ecx]" },
          { "str":"push    ebx" },
          { "str":"push    esi" },
          { "str":"push    edi" },
          { "str":"mov     dword_10003348, ecx" },
          { "str":"jnz     loc_100011A3" }
        ],
        "callees":[]
      },
{
        "tag":"label_4",
        "label":"label_4",
        "out_true":"loc_10001102",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"mov     ecx, large fs:18h" },
          { "str":"mov     edi, [ecx+4]" },
          { "str":"mov     esi, ds:InterlockedCompareExchange" },
          { "str":"mov     [ebp+Memory], eax" },
          { "str":"push    eax" },
          { "str":"mov     ebx, offset Destination" },
          { "str":"jmp     short loc_10001102" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100010EA",
        "label":"loc_100010EA",
        "out_true":"locret_100012BA",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"xor     eax, eax" },
          { "str":"jmp     locret_100012BA" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100010F1",
        "label":"loc_100010F1",
        "out_true":"loc_1000110C",
        "out_false":"label_5",
        "last_inst":"jz",
        "instructions":[
          { "str":"cmp     eax, edi" },
          { "str":"jz      short loc_1000110C" }
        ],
        "callees":[]
      },
{
        "tag":"label_5",
        "label":"label_5",
        "out_true":"loc_10001102",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    3E8h" },
          { "str":"call    ds:Sleep" },
          { "str":"push    0" }
        ],
        "callees":[
          { "tag":"ds_Sleep" }
        ]
      },
{
        "tag":"loc_10001102",
        "label":"loc_10001102",
        "out_true":"loc_100010F1",
        "out_false":"label_6",
        "last_inst":"jnz",
        "instructions":[
          { "str":"push    edi" },
          { "str":"push    ebx" },
          { "str":"call    esi" },
          { "str":"test    eax, eax" },
          { "str":"jnz     short loc_100010F1" }
        ],
        "callees":[
          { "tag":"esi" }
        ]
      },
{
        "tag":"label_6",
        "label":"label_6",
        "out_true":"loc_10001113",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"jmp     short loc_10001113" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000110C",
        "label":"loc_1000110C",
        "out_true":"loc_10001113",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"mov     [ebp+Memory], 1" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001113",
        "label":"loc_10001113",
        "out_true":"loc_10001128",
        "out_false":"label_7",
        "last_inst":"jz",
        "instructions":[
          { "str":"mov     eax, dword_1000334C" },
          { "str":"push    2" },
          { "str":"pop     esi" },
          { "str":"test    eax, eax" },
          { "str":"jz      short loc_10001128" }
        ],
        "callees":[]
      },
{
        "tag":"label_7",
        "label":"label_7",
        "out_true":"loc_10001164",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"push    1Fh" },
          { "str":"call    _amsg_exit" },
          { "str":"jmp     short loc_10001164" }
        ],
        "callees":[
          { "tag":"_amsg_exit" }
        ]
      },
{
        "tag":"loc_10001128",
        "label":"loc_10001128",
        "out_true":"loc_1000114E",
        "out_false":"label_8",
        "last_inst":"jz",
        "instructions":[
          { "str":"push    offset unk_10002098" },
          { "str":"push    offset unk_10002090" },
          { "str":"mov     dword_1000334C, 1" },
          { "str":"call    _initterm_e" },
          { "str":"pop     ecx" },
          { "str":"pop     ecx" },
          { "str":"test    eax, eax" },
          { "str":"jz      short loc_1000114E" }
        ],
        "callees":[
          { "tag":"_initterm_e" }
        ]
      },
{
        "tag":"label_8",
        "label":"label_8",
        "out_true":"loc_100012B7",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"xor     eax, eax" },
          { "str":"jmp     loc_100012B7" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000114E",
        "label":"loc_1000114E",
        "out_true":"loc_10001164",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    offset unk_1000208C" },
          { "str":"push    offset unk_10002088" },
          { "str":"call    _initterm" },
          { "str":"pop     ecx" },
          { "str":"mov     dword_1000334C, esi" }
        ],
        "callees":[
          { "tag":"_initterm" }
        ]
      },
{
        "tag":"loc_10001164",
        "label":"loc_10001164",
        "out_true":"loc_10001174",
        "out_false":"label_9",
        "last_inst":"jnz",
        "instructions":[
          { "str":"xor     edi, edi" },
          { "str":"pop     ecx" },
          { "str":"cmp     [ebp+Memory], edi" },
          { "str":"jnz     short loc_10001174" }
        ],
        "callees":[]
      },
{
        "tag":"label_9",
        "label":"label_9",
        "out_true":"loc_10001174",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    edi" },
          { "str":"push    ebx" },
          { "str":"call    ds:InterlockedExchange" }
        ],
        "callees":[
          { "tag":"ds_InterlockedExchange" }
        ]
      },
{
        "tag":"loc_10001174",
        "label":"loc_10001174",
        "out_true":"loc_10001198",
        "out_false":"label_10",
        "last_inst":"jz",
        "instructions":[
          { "str":"cmp     dword_1000335C, edi" },
          { "str":"jz      short loc_10001198" }
        ],
        "callees":[]
      },
{
        "tag":"label_10",
        "label":"label_10",
        "out_true":"loc_10001198",
        "out_false":"label_11",
        "last_inst":"jz",
        "instructions":[
          { "str":"push    offset dword_1000335C" },
          { "str":"call    sub_100016B0" },
          { "str":"pop     ecx" },
          { "str":"test    eax, eax" },
          { "str":"jz      short loc_10001198" }
        ],
        "callees":[
          { "tag":"sub_100016B0" }
        ]
      },
{
        "tag":"label_11",
        "label":"label_11",
        "out_true":"loc_10001198",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    [ebp+arg_8]" },
          { "str":"push    esi" },
          { "str":"push    [ebp+arg_0]" },
          { "str":"call    dword_1000335C" }
        ],
        "callees":[
          { "tag":"dword_1000335C" }
        ]
      },
{
        "tag":"loc_10001198",
        "label":"loc_10001198",
        "out_true":"loc_100012B4",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"inc     dword_10003010" },
          { "str":"jmp     loc_100012B4" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100011A3",
        "label":"loc_100011A3",
        "out_true":"loc_100012B4",
        "out_false":"label_12",
        "last_inst":"jnz",
        "instructions":[
          { "str":"cmp     [ebp+Memory], eax" },
          { "str":"jnz     loc_100012B4" }
        ],
        "callees":[]
      },
{
        "tag":"label_12",
        "label":"label_12",
        "out_true":"loc_100011D5",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"mov     eax, large fs:18h" },
          { "str":"mov     edi, [eax+4]" },
          { "str":"and     [ebp+var_4], 0" },
          { "str":"mov     esi, ds:InterlockedCompareExchange" },
          { "str":"mov     ebx, offset Destination" },
          { "str":"jmp     short loc_100011D5" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100011C6",
        "label":"loc_100011C6",
        "out_true":"loc_100011E1",
        "out_false":"label_13",
        "last_inst":"jz",
        "instructions":[
          { "str":"cmp     eax, edi" },
          { "str":"jz      short loc_100011E1" }
        ],
        "callees":[]
      },
{
        "tag":"label_13",
        "label":"label_13",
        "out_true":"loc_100011D5",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    3E8h" },
          { "str":"call    ds:Sleep" }
        ],
        "callees":[
          { "tag":"ds_Sleep" }
        ]
      },
{
        "tag":"loc_100011D5",
        "label":"loc_100011D5",
        "out_true":"loc_100011C6",
        "out_false":"label_14",
        "last_inst":"jnz",
        "instructions":[
          { "str":"push    0" },
          { "str":"push    edi" },
          { "str":"push    ebx" },
          { "str":"call    esi" },
          { "str":"test    eax, eax" },
          { "str":"jnz     short loc_100011C6" }
        ],
        "callees":[
          { "tag":"esi" }
        ]
      },
{
        "tag":"label_14",
        "label":"label_14",
        "out_true":"loc_100011E8",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"jmp     short loc_100011E8" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100011E1",
        "label":"loc_100011E1",
        "out_true":"loc_100011E8",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"mov     [ebp+var_4], 1" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100011E8",
        "label":"loc_100011E8",
        "out_true":"loc_100011FF",
        "out_false":"label_15",
        "last_inst":"jz",
        "instructions":[
          { "str":"mov     eax, dword_1000334C" },
          { "str":"cmp     eax, 2" },
          { "str":"jz      short loc_100011FF" }
        ],
        "callees":[]
      },
{
        "tag":"label_15",
        "label":"label_15",
        "out_true":"loc_100012B4",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"push    1Fh" },
          { "str":"call    _amsg_exit" },
          { "str":"pop     ecx" },
          { "str":"jmp     loc_100012B4" }
        ],
        "callees":[
          { "tag":"_amsg_exit" }
        ]
      },
{
        "tag":"loc_100011FF",
        "label":"loc_100011FF",
        "out_true":"loc_100012A0",
        "out_false":"label_16",
        "last_inst":"jz",
        "instructions":[
          { "str":"push    dword_10003358" },
          { "str":"mov     esi, ds:_decode_pointer" },
          { "str":"call    esi" },
          { "str":"pop     ecx" },
          { "str":"mov     [ebp+Memory], eax" },
          { "str":"test    eax, eax" },
          { "str":"jz      loc_100012A0" }
        ],
        "callees":[
          { "tag":"esi" }
        ]
      },
{
        "tag":"label_16",
        "label":"label_16",
        "out_true":"loc_1000122D",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    dword_10003354" },
          { "str":"call    esi" },
          { "str":"mov     edi, eax" },
          { "str":"mov     eax, [ebp+Memory]" },
          { "str":"pop     ecx" },
          { "str":"mov     [ebp+arg_8], eax" },
          { "str":"mov     [ebp+arg_0], edi" }
        ],
        "callees":[
          { "tag":"esi" }
        ]
      },
{
        "tag":"loc_1000122D",
        "label":"loc_1000122D",
        "out_true":"loc_10001286",
        "out_false":"label_17",
        "last_inst":"jb",
        "instructions":[
          { "str":"sub     edi, 4" },
          { "str":"cmp     edi, [ebp+Memory]" },
          { "str":"jb      short loc_10001286" }
        ],
        "callees":[]
      },
{
        "tag":"label_17",
        "label":"label_17",
        "out_true":"loc_1000122D",
        "out_false":"label_18",
        "last_inst":"jz",
        "instructions":[
          { "str":"cmp     dword ptr [edi], 0" },
          { "str":"jz      short loc_1000122D" }
        ],
        "callees":[]
      },
{
        "tag":"label_18",
        "label":"label_18",
        "out_true":"loc_1000122D",
        "out_false":"label_19",
        "last_inst":"jz",
        "instructions":[
          { "str":"call    ds:_encoded_null" },
          { "str":"cmp     [edi], eax" },
          { "str":"jz      short loc_1000122D" }
        ],
        "callees":[
          { "tag":"ds__encoded_null" }
        ]
      },
{
        "tag":"label_19",
        "label":"label_19",
        "out_true":"loc_10001279",
        "out_false":"label_20",
        "last_inst":"jnz",
        "instructions":[
          { "str":"push    dword ptr [edi]" },
          { "str":"call    esi" },
          { "str":"mov     [ebp+var_8], eax" },
          { "str":"call    ds:_encoded_null" },
          { "str":"mov     [edi], eax" },
          { "str":"call    [ebp+var_8]" },
          { "str":"push    dword_10003358" },
          { "str":"call    esi" },
          { "str":"push    dword_10003354" },
          { "str":"mov     [ebp+var_8], eax" },
          { "str":"call    esi" },
          { "str":"mov     ecx, [ebp+var_8]" },
          { "str":"add     esp, 0Ch" },
          { "str":"cmp     [ebp+arg_8], ecx" },
          { "str":"jnz     short loc_10001279" }
        ],
        "callees":[
          { "tag":"_ebp_var_8_" },
          { "tag":"ds__encoded_null" },
          { "tag":"esi" }
        ]
      },
{
        "tag":"label_20",
        "label":"label_20",
        "out_true":"loc_1000122D",
        "out_false":"loc_10001279",
        "last_inst":"jz",
        "instructions":[
          { "str":"cmp     [ebp+arg_0], eax" },
          { "str":"jz      short loc_1000122D" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001279",
        "label":"loc_10001279",
        "out_true":"loc_1000122D",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"mov     [ebp+arg_8], ecx" },
          { "str":"mov     [ebp+Memory], ecx" },
          { "str":"mov     [ebp+arg_0], eax" },
          { "str":"mov     edi, eax" },
          { "str":"jmp     short loc_1000122D" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001286",
        "label":"loc_10001286",
        "out_true":"loc_100012A0",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    [ebp+Memory]" },
          { "str":"call    ds:free" },
          { "str":"pop     ecx" },
          { "str":"call    ds:_encoded_null" },
          { "str":"mov     dword_10003354, eax" },
          { "str":"mov     dword_10003358, eax" }
        ],
        "callees":[
          { "tag":"ds__encoded_null" },
          { "tag":"ds_free" }
        ]
      },
{
        "tag":"loc_100012A0",
        "label":"loc_100012A0",
        "out_true":"loc_100012B4",
        "out_false":"label_21",
        "last_inst":"jnz",
        "instructions":[
          { "str":"xor     eax, eax" },
          { "str":"mov     dword_1000334C, eax" },
          { "str":"cmp     [ebp+var_4], eax" },
          { "str":"jnz     short loc_100012B4" }
        ],
        "callees":[]
      },
{
        "tag":"label_21",
        "label":"label_21",
        "out_true":"loc_100012B4",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    eax" },
          { "str":"push    ebx" },
          { "str":"call    ds:InterlockedExchange" }
        ],
        "callees":[
          { "tag":"ds_InterlockedExchange" }
        ]
      },
{
        "tag":"loc_100012B4",
        "label":"loc_100012B4",
        "out_true":"loc_100012B7",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"xor     eax, eax" },
          { "str":"inc     eax" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100012B7",
        "label":"loc_100012B7",
        "out_true":"locret_100012BA",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"pop     edi" },
          { "str":"pop     esi" },
          { "str":"pop     ebx" }
        ],
        "callees":[]
      },
{
        "tag":"locret_100012BA",
        "label":"locret_100012BA",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"leave" },
          { "str":"retn    0Ch" }
        ],
        "callees":[]
      }
    ]
  },{
    "tag":"rtn_1",
    "label":"rtn_1",
    "type":"ours",
    "callees":[
      { "tag":"__SEH_prolog4" },
      { "tag":"eax" },
      { "tag":"sub_10001000" },
      { "tag":"sub_10001098" }
    ],
    "blocks":[
      {
        "tag":"blk_22",
        "label":"blk_22",
        "out_true":"loc_100012F9",
        "out_false":"label_23",
        "last_inst":"jnz",
        "instructions":[
          { "str":"push    10h" },
          { "str":"push    offset unk_10002198" },
          { "str":"call    __SEH_prolog4" },
          { "str":"mov     edi, ecx" },
          { "str":"mov     esi, edx" },
          { "str":"mov     ebx, [ebp+8]" },
          { "str":"xor     eax, eax" },
          { "str":"inc     eax" },
          { "str":"mov     [ebp-1Ch], eax" },
          { "str":"xor     ecx, ecx" },
          { "str":"mov     [ebp-4], ecx" },
          { "str":"mov     dword_10003008, esi" },
          { "str":"mov     [ebp-4], eax" },
          { "str":"cmp     esi, ecx" },
          { "str":"jnz     short loc_100012F9" }
        ],
        "callees":[
          { "tag":"__SEH_prolog4" }
        ]
      },
{
        "tag":"label_23",
        "label":"label_23",
        "out_true":"loc_100012F9",
        "out_false":"label_24",
        "last_inst":"jnz",
        "instructions":[
          { "str":"cmp     dword_10003010, ecx" },
          { "str":"jnz     short loc_100012F9" }
        ],
        "callees":[]
      },
{
        "tag":"label_24",
        "label":"label_24",
        "out_true":"loc_100013B0",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"mov     [ebp-1Ch], ecx" },
          { "str":"jmp     loc_100013B0" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100012F9",
        "label":"loc_100012F9",
        "out_true":"loc_10001302",
        "out_false":"label_25",
        "last_inst":"jz",
        "instructions":[
          { "str":"cmp     esi, eax" },
          { "str":"jz      short loc_10001302" }
        ],
        "callees":[]
      },
{
        "tag":"label_25",
        "label":"label_25",
        "out_true":"loc_10001330",
        "out_false":"loc_10001302",
        "last_inst":"jnz",
        "instructions":[
          { "str":"cmp     esi, 2" },
          { "str":"jnz     short loc_10001330" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001302",
        "label":"loc_10001302",
        "out_true":"loc_10001313",
        "out_false":"label_26",
        "last_inst":"jz",
        "instructions":[
          { "str":"mov     eax, ds:dword_100020BC" },
          { "str":"cmp     eax, ecx" },
          { "str":"jz      short loc_10001313" }
        ],
        "callees":[]
      },
{
        "tag":"label_26",
        "label":"label_26",
        "out_true":"loc_10001313",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    edi" },
          { "str":"push    esi" },
          { "str":"push    ebx" },
          { "str":"call    eax" },
          { "str":"mov     [ebp-1Ch], eax" }
        ],
        "callees":[
          { "tag":"eax" }
        ]
      },
{
        "tag":"loc_10001313",
        "label":"loc_10001313",
        "out_true":"loc_100013B0",
        "out_false":"label_27",
        "last_inst":"jz",
        "instructions":[
          { "str":"cmp     dword ptr [ebp-1Ch], 0" },
          { "str":"jz      loc_100013B0" }
        ],
        "callees":[]
      },
{
        "tag":"label_27",
        "label":"label_27",
        "out_true":"loc_100013B0",
        "out_false":"loc_10001330",
        "last_inst":"jz",
        "instructions":[
          { "str":"push    edi" },
          { "str":"push    esi" },
          { "str":"push    ebx" },
          { "str":"call    sub_10001098" },
          { "str":"mov     [ebp-1Ch], eax" },
          { "str":"test    eax, eax" },
          { "str":"jz      loc_100013B0" }
        ],
        "callees":[
          { "tag":"sub_10001098" }
        ]
      },
{
        "tag":"loc_10001330",
        "label":"loc_10001330",
        "out_true":"loc_10001364",
        "out_false":"label_28",
        "last_inst":"jnz",
        "instructions":[
          { "str":"push    edi" },
          { "str":"push    esi" },
          { "str":"push    ebx" },
          { "str":"call    sub_10001000" },
          { "str":"mov     [ebp-1Ch], eax" },
          { "str":"cmp     esi, 1" },
          { "str":"jnz     short loc_10001364" }
        ],
        "callees":[
          { "tag":"sub_10001000" }
        ]
      },
{
        "tag":"label_28",
        "label":"label_28",
        "out_true":"loc_10001364",
        "out_false":"label_29",
        "last_inst":"jnz",
        "instructions":[
          { "str":"test    eax, eax" },
          { "str":"jnz     short loc_10001364" }
        ],
        "callees":[]
      },
{
        "tag":"label_29",
        "label":"label_29",
        "out_true":"loc_10001364",
        "out_false":"label_30",
        "last_inst":"jz",
        "instructions":[
          { "str":"push    edi" },
          { "str":"push    eax" },
          { "str":"push    ebx" },
          { "str":"call    sub_10001000" },
          { "str":"push    edi" },
          { "str":"push    0" },
          { "str":"push    ebx" },
          { "str":"call    sub_10001098" },
          { "str":"mov     eax, ds:dword_100020BC" },
          { "str":"test    eax, eax" },
          { "str":"jz      short loc_10001364" }
        ],
        "callees":[
          { "tag":"sub_10001000" },
          { "tag":"sub_10001098" }
        ]
      },
{
        "tag":"label_30",
        "label":"label_30",
        "out_true":"loc_10001364",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    edi" },
          { "str":"push    0" },
          { "str":"push    ebx" },
          { "str":"call    eax" }
        ],
        "callees":[
          { "tag":"eax" }
        ]
      },
{
        "tag":"loc_10001364",
        "label":"loc_10001364",
        "out_true":"loc_1000136D",
        "out_false":"label_31",
        "last_inst":"jz",
        "instructions":[
          { "str":"test    esi, esi" },
          { "str":"jz      short loc_1000136D" }
        ],
        "callees":[]
      },
{
        "tag":"label_31",
        "label":"label_31",
        "out_true":"loc_100013B0",
        "out_false":"loc_1000136D",
        "last_inst":"jnz",
        "instructions":[
          { "str":"cmp     esi, 3" },
          { "str":"jnz     short loc_100013B0" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000136D",
        "label":"loc_1000136D",
        "out_true":"loc_1000137C",
        "out_false":"label_32",
        "last_inst":"jnz",
        "instructions":[
          { "str":"push    edi" },
          { "str":"push    esi" },
          { "str":"push    ebx" },
          { "str":"call    sub_10001098" },
          { "str":"test    eax, eax" },
          { "str":"jnz     short loc_1000137C" }
        ],
        "callees":[
          { "tag":"sub_10001098" }
        ]
      },
{
        "tag":"label_32",
        "label":"label_32",
        "out_true":"loc_1000137C",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"and     [ebp-1Ch], eax" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000137C",
        "label":"loc_1000137C",
        "out_true":"loc_100013B0",
        "out_false":"label_33",
        "last_inst":"jz",
        "instructions":[
          { "str":"cmp     dword ptr [ebp-1Ch], 0" },
          { "str":"jz      short loc_100013B0" }
        ],
        "callees":[]
      },
{
        "tag":"label_33",
        "label":"label_33",
        "out_true":"loc_100013B0",
        "out_false":"label_34",
        "last_inst":"jz",
        "instructions":[
          { "str":"mov     eax, ds:dword_100020BC" },
          { "str":"test    eax, eax" },
          { "str":"jz      short loc_100013B0" }
        ],
        "callees":[]
      },
{
        "tag":"label_34",
        "label":"label_34",
        "out_true":"loc_100013B0",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"push    edi" },
          { "str":"push    esi" },
          { "str":"push    ebx" },
          { "str":"call    eax" },
          { "str":"mov     [ebp-1Ch], eax" },
          { "str":"jmp     short loc_100013B0" }
        ],
        "callees":[
          { "tag":"eax" }
        ]
      }
    ]
  },{
    "tag":"sub_10001395",
    "label":"sub_10001395",
    "type":"idapro",
    "callees":[
      { "tag":"__CppXcptFilter" }
    ],
    "blocks":[
      {
        "tag":"sub_10001395",
        "label":"sub_10001395",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"mov     eax, [ebp-14h]" },
          { "str":"mov     ecx, [eax]" },
          { "str":"mov     ecx, [ecx]" },
          { "str":"mov     [ebp-20h], ecx" },
          { "str":"push    eax" },
          { "str":"push    ecx" },
          { "str":"call    __CppXcptFilter" },
          { "str":"pop     ecx" },
          { "str":"pop     ecx" },
          { "str":"retn" }
        ],
        "callees":[
          { "tag":"__CppXcptFilter" }
        ]
      }
    ]
  },{
    "tag":"sub_100013A9",
    "label":"sub_100013A9",
    "type":"idapro",
    "callees":[
      { "tag":"__SEH_epilog4" },
      { "tag":"sub_100013C9" }
    ],
    "blocks":[
      {
        "tag":"sub_100013A9",
        "label":"sub_100013A9",
        "out_true":"loc_100013B0",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"mov     esp, [ebp-18h]" },
          { "str":"and     dword ptr [ebp-1Ch], 0" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100013B0",
        "label":"loc_100013B0",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"and     dword ptr [ebp-4], 0" },
          { "str":"mov     dword ptr [ebp-4], 0FFFFFFFEh" },
          { "str":"call    sub_100013C9" },
          { "str":"mov     eax, [ebp-1Ch]" },
          { "str":"call    __SEH_epilog4" },
          { "str":"retn" }
        ],
        "callees":[
          { "tag":"__SEH_epilog4" },
          { "tag":"sub_100013C9" }
        ]
      }
    ]
  },{
    "tag":"sub_100013C9",
    "label":"sub_100013C9",
    "type":"idapro",
    "callees":[],
    "blocks":[
      {
        "tag":"sub_100013C9",
        "label":"sub_100013C9",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"mov     dword_10003008, 0FFFFFFFFh" },
          { "str":"retn" }
        ],
        "callees":[]
      }
    ]
  },{
    "tag":"rtn_2",
    "label":"rtn_2",
    "type":"ours",
    "callees":[
      { "tag":"_crt_debugger_hook" },
      { "tag":"ds_GetCurrentProcess" },
      { "tag":"ds_IsDebuggerPresent" },
      { "tag":"ds_SetUnhandledExceptionFilter" },
      { "tag":"ds_TerminateProcess" },
      { "tag":"ds_UnhandledExceptionFilter" },
      { "tag":"ds_VirtualAlloc" },
      { "tag":"edi" }
    ],
    "blocks":[
      {
        "tag":"blk_35",
        "label":"blk_35",
        "out_true":"loc_1000141F",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"sub     esp, 4" },
          { "str":"pusha" },
          { "str":"mov     edi, 10h" },
          { "str":"lea     edx, [edi+edi*2+10h]" },
          { "str":"push    edx" },
          { "str":"mov     eax, 400h" },
          { "str":"imul    eax, 4" },
          { "str":"push    eax" },
          { "str":"mov     edi, 1" },
          { "str":"shl     edi, 0Bh" },
          { "str":"push    edi" },
          { "str":"push    0" },
          { "str":"call    ds:VirtualAlloc" },
          { "str":"mov     ebx, eax" },
          { "str":"mov     ecx, 1" },
          { "str":"imul    ecx, offset unk_100040CC" },
          { "str":"mov     edx, 0" },
          { "str":"xor     edx, ecx" },
          { "str":"add     edx, 0EFFFBF34h" },
          { "str":"push    edx" },
          { "str":"push    ebx" },
          { "str":"mov     esi, [ecx]" },
          { "str":"mov     eax, esi" },
          { "str":"add     ecx, 4" }
        ],
        "callees":[
          { "tag":"ds_VirtualAlloc" }
        ]
      },
{
        "tag":"loc_1000141F",
        "label":"loc_1000141F",
        "out_true":"loc_1000141F",
        "out_false":"label_36",
        "last_inst":"jnz",
        "instructions":[
          { "str":"lea     esi, [ecx+eax-1]" },
          { "str":"movzx   edx, byte ptr [esi]" },
          { "str":"lea     edi, [ebx+eax-1]" },
          { "str":"mov     [edi], dl" },
          { "str":"add     eax, 0FFFFFFFFh" },
          { "str":"cmp     eax, 0" },
          { "str":"jnz     short loc_1000141F" }
        ],
        "callees":[]
      },
{
        "tag":"label_36",
        "label":"label_36",
        "out_true":"loc_100014E9",
        "out_false":"label_37",
        "last_inst":"jnz",
        "instructions":[
          { "str":"pop     edi" },
          { "str":"mov     [edi+1], edi" },
          { "str":"call    edi" },
          { "str":"mov     word_10003104, es" },
          { "str":"mov     word_10003100, fs" },
          { "str":"mov     word_100030FC, gs" },
          { "str":"pushf" },
          { "str":"pop     dword_10003130" },
          { "str":"mov     eax, [ebp+0]" },
          { "str":"mov     dword_10003124, eax" },
          { "str":"mov     eax, [ebp+4]" },
          { "str":"mov     dword_10003128, eax" },
          { "str":"lea     eax, [ebp+8]" },
          { "str":"mov     dword_10003134, eax" },
          { "str":"mov     eax, [ebp-320h]" },
          { "str":"mov     dword_10003070, 10001h" },
          { "str":"mov     eax, dword_10003128" },
          { "str":"mov     dword_10003024, eax" },
          { "str":"mov     dword_10003018, 0C0000409h" },
          { "str":"mov     dword_1000301C, 1" },
          { "str":"mov     eax, ___security_cookie" },
          { "str":"mov     [ebp-328h], eax" },
          { "str":"mov     eax, dword_10003004" },
          { "str":"mov     [ebp-324h], eax" },
          { "str":"call    ds:IsDebuggerPresent" },
          { "str":"mov     dword_10003068, eax" },
          { "str":"push    1" },
          { "str":"call    _crt_debugger_hook" },
          { "str":"pop     ecx" },
          { "str":"push    0" },
          { "str":"call    ds:SetUnhandledExceptionFilter" },
          { "str":"push    offset ExceptionInfo" },
          { "str":"call    ds:UnhandledExceptionFilter" },
          { "str":"cmp     dword_10003068, 0" },
          { "str":"jnz     short loc_100014E9" }
        ],
        "callees":[
          { "tag":"_crt_debugger_hook" },
          { "tag":"ds_IsDebuggerPresent" },
          { "tag":"ds_SetUnhandledExceptionFilter" },
          { "tag":"ds_UnhandledExceptionFilter" },
          { "tag":"edi" }
        ]
      },
{
        "tag":"label_37",
        "label":"label_37",
        "out_true":"loc_100014E9",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    1" },
          { "str":"call    _crt_debugger_hook" },
          { "str":"pop     ecx" }
        ],
        "callees":[
          { "tag":"_crt_debugger_hook" }
        ]
      },
{
        "tag":"loc_100014E9",
        "label":"loc_100014E9",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"push    0C0000409h" },
          { "str":"call    ds:GetCurrentProcess" },
          { "str":"push    eax" },
          { "str":"call    ds:TerminateProcess" },
          { "str":"leave" },
          { "str":"retn" }
        ],
        "callees":[
          { "tag":"ds_GetCurrentProcess" },
          { "tag":"ds_TerminateProcess" }
        ]
      }
    ]
  },{
    "tag":"sub_100014FD",
    "label":"sub_100014FD",
    "type":"idapro",
    "callees":[
      { "tag":"__clean_type_info_names_internal" }
    ],
    "blocks":[
      {
        "tag":"sub_100014FD",
        "label":"sub_100014FD",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"push    offset unk_10003340" },
          { "str":"call    __clean_type_info_names_internal" },
          { "str":"pop     ecx" },
          { "str":"retn" }
        ],
        "callees":[
          { "tag":"__clean_type_info_names_internal" }
        ]
      }
    ]
  },{
    "tag":"sub_10001509",
    "label":"sub_10001509",
    "type":"idapro",
    "callees":[
      { "tag":"__SEH_epilog4" },
      { "tag":"__SEH_prolog4" },
      { "tag":"__dllonexit" },
      { "tag":"_lock" },
      { "tag":"_unlock" },
      { "tag":"ds__onexit" },
      { "tag":"esi" },
      { "tag":"loc_100015A5" }
    ],
    "blocks":[
      {
        "tag":"sub_10001509",
        "label":"sub_10001509",
        "out_true":"loc_10001538",
        "out_false":"label_38",
        "last_inst":"jnz",
        "instructions":[
          { "str":"push    14h" },
          { "str":"push    offset stru_100021C0" },
          { "str":"call    __SEH_prolog4" },
          { "str":"push    dword_10003358" },
          { "str":"mov     esi, ds:_decode_pointer" },
          { "str":"call    esi" },
          { "str":"pop     ecx" },
          { "str":"mov     [ebp+var_1C], eax" },
          { "str":"cmp     eax, 0FFFFFFFFh" },
          { "str":"jnz     short loc_10001538" }
        ],
        "callees":[
          { "tag":"__SEH_prolog4" },
          { "tag":"esi" }
        ]
      },
{
        "tag":"label_38",
        "label":"label_38",
        "out_true":"loc_1000159F",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"push    [ebp+Func]" },
          { "str":"call    ds:_onexit" },
          { "str":"pop     ecx" },
          { "str":"jmp     short loc_1000159F" }
        ],
        "callees":[
          { "tag":"ds__onexit" }
        ]
      },
{
        "tag":"loc_10001538",
        "label":"loc_10001538",
        "out_true":"loc_1000159C",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"push    8" },
          { "str":"call    _lock" },
          { "str":"pop     ecx" },
          { "str":"and     [ebp+ms_exc.registration.TryLevel], 0" },
          { "str":"push    dword_10003358" },
          { "str":"call    esi" },
          { "str":"mov     [ebp+var_1C], eax" },
          { "str":"push    dword_10003354" },
          { "str":"call    esi" },
          { "str":"pop     ecx" },
          { "str":"pop     ecx" },
          { "str":"mov     [ebp+var_20], eax" },
          { "str":"lea     eax, [ebp+var_20]" },
          { "str":"push    eax" },
          { "str":"lea     eax, [ebp+var_1C]" },
          { "str":"push    eax" },
          { "str":"push    [ebp+Func]" },
          { "str":"mov     esi, ds:_encode_pointer" },
          { "str":"call    esi" },
          { "str":"pop     ecx" },
          { "str":"push    eax" },
          { "str":"call    __dllonexit" },
          { "str":"mov     [ebp+var_24], eax" },
          { "str":"push    [ebp+var_1C]" },
          { "str":"call    esi" },
          { "str":"mov     dword_10003358, eax" },
          { "str":"push    [ebp+var_20]" },
          { "str":"call    esi" },
          { "str":"add     esp, 14h" },
          { "str":"mov     dword_10003354, eax" },
          { "str":"mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh" },
          { "str":"call    loc_100015A5" }
        ],
        "callees":[
          { "tag":"__dllonexit" },
          { "tag":"_lock" },
          { "tag":"esi" },
          { "tag":"loc_100015A5" }
        ]
      },
{
        "tag":"loc_1000159C",
        "label":"loc_1000159C",
        "out_true":"loc_1000159F",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"mov     eax, [ebp+var_24]" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000159F",
        "label":"loc_1000159F",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"call    __SEH_epilog4" },
          { "str":"retn" }
        ],
        "callees":[
          { "tag":"__SEH_epilog4" }
        ]
      },
{
        "tag":"loc_100015A5",
        "label":"loc_100015A5",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"push    8" },
          { "str":"call    _unlock" },
          { "str":"pop     ecx" },
          { "str":"retn" }
        ],
        "callees":[
          { "tag":"_unlock" }
        ]
      }
    ]
  },{
    "tag":"sub_100015AE",
    "label":"sub_100015AE",
    "type":"idapro",
    "callees":[
      { "tag":"sub_10001509" }
    ],
    "blocks":[
      {
        "tag":"sub_100015AE",
        "label":"sub_100015AE",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"mov     edi, edi" },
          { "str":"push    ebp" },
          { "str":"mov     ebp, esp" },
          { "str":"push    [ebp+Func]" },
          { "str":"call    sub_10001509" },
          { "str":"neg     eax" },
          { "str":"sbb     eax, eax" },
          { "str":"neg     eax" },
          { "str":"pop     ecx" },
          { "str":"dec     eax" },
          { "str":"pop     ebp" },
          { "str":"retn" }
        ],
        "callees":[
          { "tag":"sub_10001509" }
        ]
      }
    ]
  },{
    "tag":"sub_100015C5",
    "label":"sub_100015C5",
    "type":"idapro",
    "callees":[
      { "tag":"eax" }
    ],
    "blocks":[
      {
        "tag":"sub_100015C5",
        "label":"sub_100015C5",
        "out_true":"loc_100015E8",
        "out_false":"loc_100015D9",
        "last_inst":"jnb",
        "instructions":[
          { "str":"mov     edi, edi" },
          { "str":"push    esi" },
          { "str":"mov     eax, offset unk_10002188" },
          { "str":"mov     esi, offset unk_10002188" },
          { "str":"push    edi" },
          { "str":"mov     edi, eax" },
          { "str":"cmp     eax, esi" },
          { "str":"jnb     short loc_100015E8" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100015D9",
        "label":"loc_100015D9",
        "out_true":"loc_100015E1",
        "out_false":"label_39",
        "last_inst":"jz",
        "instructions":[
          { "str":"mov     eax, [edi]" },
          { "str":"test    eax, eax" },
          { "str":"jz      short loc_100015E1" }
        ],
        "callees":[]
      },
{
        "tag":"label_39",
        "label":"label_39",
        "out_true":"loc_100015E1",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"call    eax" }
        ],
        "callees":[
          { "tag":"eax" }
        ]
      },
{
        "tag":"loc_100015E1",
        "label":"loc_100015E1",
        "out_true":"loc_100015D9",
        "out_false":"loc_100015E8",
        "last_inst":"jb",
        "instructions":[
          { "str":"add     edi, 4" },
          { "str":"cmp     edi, esi" },
          { "str":"jb      short loc_100015D9" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100015E8",
        "label":"loc_100015E8",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"pop     edi" },
          { "str":"pop     esi" },
          { "str":"retn" }
        ],
        "callees":[]
      }
    ]
  },{
    "tag":"rtn_3",
    "label":"rtn_3",
    "type":"ours",
    "callees":[
      { "tag":"eax" }
    ],
    "blocks":[
      {
        "tag":"blk_40",
        "label":"blk_40",
        "out_true":"loc_1000160E",
        "out_false":"loc_100015FF",
        "last_inst":"jnb",
        "instructions":[
          { "str":"push    esi" },
          { "str":"mov     eax, offset unk_10002190" },
          { "str":"mov     esi, offset unk_10002190" },
          { "str":"push    edi" },
          { "str":"mov     edi, eax" },
          { "str":"cmp     eax, esi" },
          { "str":"jnb     short loc_1000160E" }
        ],
        "callees":[]
      },
{
        "tag":"loc_100015FF",
        "label":"loc_100015FF",
        "out_true":"loc_10001607",
        "out_false":"label_41",
        "last_inst":"jz",
        "instructions":[
          { "str":"mov     eax, [edi]" },
          { "str":"test    eax, eax" },
          { "str":"jz      short loc_10001607" }
        ],
        "callees":[]
      },
{
        "tag":"label_41",
        "label":"label_41",
        "out_true":"loc_10001607",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"call    eax" }
        ],
        "callees":[
          { "tag":"eax" }
        ]
      },
{
        "tag":"loc_10001607",
        "label":"loc_10001607",
        "out_true":"loc_100015FF",
        "out_false":"loc_1000160E",
        "last_inst":"jb",
        "instructions":[
          { "str":"add     edi, 4" },
          { "str":"cmp     edi, esi" },
          { "str":"jb      short loc_100015FF" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000160E",
        "label":"loc_1000160E",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"pop     edi" },
          { "str":"pop     esi" },
          { "str":"retn" }
        ],
        "callees":[]
      }
    ]
  },{
    "tag":"sub_10001620",
    "label":"sub_10001620",
    "type":"idapro",
    "callees":[],
    "blocks":[
      {
        "tag":"sub_10001620",
        "label":"sub_10001620",
        "out_true":"loc_10001636",
        "out_false":"loc_10001632",
        "last_inst":"jz",
        "instructions":[
          { "str":"mov     edi, edi" },
          { "str":"push    ebp" },
          { "str":"mov     ebp, esp" },
          { "str":"mov     ecx, [ebp+arg_0]" },
          { "str":"mov     eax, 5A4Dh" },
          { "str":"cmp     [ecx], ax" },
          { "str":"jz      short loc_10001636" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001632",
        "label":"loc_10001632",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"xor     eax, eax" },
          { "str":"pop     ebp" },
          { "str":"retn" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001636",
        "label":"loc_10001636",
        "out_true":"loc_10001632",
        "out_false":"label_42",
        "last_inst":"jnz",
        "instructions":[
          { "str":"mov     eax, [ecx+3Ch]" },
          { "str":"add     eax, ecx" },
          { "str":"cmp     dword ptr [eax], 4550h" },
          { "str":"jnz     short loc_10001632" }
        ],
        "callees":[]
      },
{
        "tag":"label_42",
        "label":"label_42",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"xor     edx, edx" },
          { "str":"mov     ecx, 10Bh" },
          { "str":"cmp     [eax+18h], cx" },
          { "str":"setz    dl" },
          { "str":"mov     eax, edx" },
          { "str":"pop     ebp" },
          { "str":"retn" }
        ],
        "callees":[]
      }
    ]
  },{
    "tag":"sub_10001660",
    "label":"sub_10001660",
    "type":"idapro",
    "callees":[],
    "blocks":[
      {
        "tag":"sub_10001660",
        "label":"sub_10001660",
        "out_true":"loc_1000169D",
        "out_false":"label_43",
        "last_inst":"jb",
        "instructions":[
          { "str":"mov     edi, edi" },
          { "str":"push    ebp" },
          { "str":"mov     ebp, esp" },
          { "str":"mov     eax, [ebp+arg_0]" },
          { "str":"mov     ecx, [eax+3Ch]" },
          { "str":"add     ecx, eax" },
          { "str":"movzx   eax, word ptr [ecx+14h]" },
          { "str":"push    ebx" },
          { "str":"push    esi" },
          { "str":"movzx   esi, word ptr [ecx+6]" },
          { "str":"xor     edx, edx" },
          { "str":"push    edi" },
          { "str":"lea     eax, [eax+ecx+18h]" },
          { "str":"test    esi, esi" },
          { "str":"jbe     short loc_1000169D" }
        ],
        "callees":[]
      },
{
        "tag":"label_43",
        "label":"label_43",
        "out_true":"loc_10001685",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"mov     edi, [ebp+arg_4]" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001685",
        "label":"loc_10001685",
        "out_true":"loc_10001695",
        "out_false":"label_44",
        "last_inst":"jb",
        "instructions":[
          { "str":"mov     ecx, [eax+0Ch]" },
          { "str":"cmp     edi, ecx" },
          { "str":"jb      short loc_10001695" }
        ],
        "callees":[]
      },
{
        "tag":"label_44",
        "label":"label_44",
        "out_true":"loc_1000169F",
        "out_false":"loc_10001695",
        "last_inst":"jb",
        "instructions":[
          { "str":"mov     ebx, [eax+8]" },
          { "str":"add     ebx, ecx" },
          { "str":"cmp     edi, ebx" },
          { "str":"jb      short loc_1000169F" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001695",
        "label":"loc_10001695",
        "out_true":"loc_10001685",
        "out_false":"loc_1000169D",
        "last_inst":"jb",
        "instructions":[
          { "str":"inc     edx" },
          { "str":"add     eax, 28h" },
          { "str":"cmp     edx, esi" },
          { "str":"jb      short loc_10001685" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000169D",
        "label":"loc_1000169D",
        "out_true":"loc_1000169F",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"xor     eax, eax" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000169F",
        "label":"loc_1000169F",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"pop     edi" },
          { "str":"pop     esi" },
          { "str":"pop     ebx" },
          { "str":"pop     ebp" },
          { "str":"retn" }
        ],
        "callees":[]
      }
    ]
  },{
    "tag":"sub_100016B0",
    "label":"sub_100016B0",
    "type":"idapro",
    "callees":[
      { "tag":"sub_10001620" },
      { "tag":"sub_10001660" }
    ],
    "blocks":[
      {
        "tag":"sub_100016B0",
        "label":"sub_100016B0",
        "out_true":"loc_10001752",
        "out_false":"label_45",
        "last_inst":"jz",
        "instructions":[
          { "str":"mov     edi, edi" },
          { "str":"push    ebp" },
          { "str":"mov     ebp, esp" },
          { "str":"push    0FFFFFFFEh" },
          { "str":"push    offset stru_100021E0" },
          { "str":"push    offset sub_100017E1" },
          { "str":"mov     eax, large fs:0" },
          { "str":"push    eax" },
          { "str":"sub     esp, 8" },
          { "str":"push    ebx" },
          { "str":"push    esi" },
          { "str":"push    edi" },
          { "str":"mov     eax, ___security_cookie" },
          { "str":"xor     [ebp+ms_exc.registration.ScopeTable], eax" },
          { "str":"xor     eax, ebp" },
          { "str":"push    eax" },
          { "str":"lea     eax, [ebp+ms_exc.registration]" },
          { "str":"mov     large fs:0, eax" },
          { "str":"mov     [ebp+ms_exc.old_esp], esp" },
          { "str":"mov     [ebp+ms_exc.registration.TryLevel], 0" },
          { "str":"push    offset __ImageBase" },
          { "str":"call    sub_10001620" },
          { "str":"add     esp, 4" },
          { "str":"test    eax, eax" },
          { "str":"jz      short loc_10001752" }
        ],
        "callees":[
          { "tag":"sub_10001620" }
        ]
      },
{
        "tag":"label_45",
        "label":"label_45",
        "out_true":"loc_10001752",
        "out_false":"label_46",
        "last_inst":"jz",
        "instructions":[
          { "str":"mov     eax, [ebp+arg_0]" },
          { "str":"sub     eax, offset __ImageBase" },
          { "str":"push    eax" },
          { "str":"push    offset __ImageBase" },
          { "str":"call    sub_10001660" },
          { "str":"add     esp, 8" },
          { "str":"test    eax, eax" },
          { "str":"jz      short loc_10001752" }
        ],
        "callees":[
          { "tag":"sub_10001660" }
        ]
      },
{
        "tag":"label_46",
        "label":"label_46",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"mov     eax, [eax+24h]" },
          { "str":"shr     eax, 1Fh" },
          { "str":"not     eax" },
          { "str":"and     eax, 1" },
          { "str":"mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh" },
          { "str":"mov     ecx, [ebp+ms_exc.registration.Next]" },
          { "str":"mov     large fs:0, ecx" },
          { "str":"pop     ecx" },
          { "str":"pop     edi" },
          { "str":"pop     esi" },
          { "str":"pop     ebx" },
          { "str":"mov     esp, ebp" },
          { "str":"pop     ebp" },
          { "str":"retn" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000173B",
        "label":"loc_1000173B",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"mov     eax, [ebp+ms_exc.exc_ptr]" },
          { "str":"mov     ecx, [eax]" },
          { "str":"mov     eax, [ecx]" },
          { "str":"xor     edx, edx" },
          { "str":"cmp     eax, 0C0000005h" },
          { "str":"setz    dl" },
          { "str":"mov     eax, edx" },
          { "str":"retn" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000174F",
        "label":"loc_1000174F",
        "out_true":"loc_10001752",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"mov     esp, [ebp+ms_exc.old_esp]" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001752",
        "label":"loc_10001752",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh" },
          { "str":"xor     eax, eax" },
          { "str":"mov     ecx, [ebp+ms_exc.registration.Next]" },
          { "str":"mov     large fs:0, ecx" },
          { "str":"pop     ecx" },
          { "str":"pop     edi" },
          { "str":"pop     esi" },
          { "str":"pop     ebx" },
          { "str":"mov     esp, ebp" },
          { "str":"pop     ebp" },
          { "str":"retn" }
        ],
        "callees":[]
      }
    ]
  },{
    "tag":"sub_100017E1",
    "label":"sub_100017E1",
    "type":"idapro",
    "callees":[
      { "tag":"_except_handler4_common" }
    ],
    "blocks":[
      {
        "tag":"sub_100017E1",
        "label":"sub_100017E1",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"mov     edi, edi" },
          { "str":"push    ebp" },
          { "str":"mov     ebp, esp" },
          { "str":"push    [ebp+arg_C]" },
          { "str":"push    [ebp+arg_8]" },
          { "str":"push    [ebp+arg_4]" },
          { "str":"push    [ebp+arg_0]" },
          { "str":"push    offset word_1000103A" },
          { "str":"push    offset ___security_cookie" },
          { "str":"call    _except_handler4_common" },
          { "str":"add     esp, 18h" },
          { "str":"pop     ebp" },
          { "str":"retn" }
        ],
        "callees":[
          { "tag":"_except_handler4_common" }
        ]
      }
    ]
  },{
    "tag":"rtn_4",
    "label":"rtn_4",
    "type":"ours",
    "callees":[
      { "tag":"ds_GetCurrentProcessId" },
      { "tag":"ds_GetProcAddress" },
      { "tag":"ds_LoadLibraryA" },
      { "tag":"ds_QueryPerformanceCounter" },
      { "tag":"ds_VirtualAlloc" }
    ],
    "blocks":[
      {
        "tag":"blk_47",
        "label":"blk_47",
        "out_true":"loc_10001838",
        "out_false":"label_48",
        "last_inst":"jz",
        "instructions":[
          { "str":"mov     edi, edi" },
          { "str":"push    ebp" },
          { "str":"mov     ebp, esp" },
          { "str":"sub     esp, 10h" },
          { "str":"mov     eax, ___security_cookie" },
          { "str":"and     dword ptr [ebp-8], 0" },
          { "str":"and     dword ptr [ebp-4], 0" },
          { "str":"push    ebx" },
          { "str":"push    edi" },
          { "str":"mov     edi, 0BB40E64Eh" },
          { "str":"mov     ebx, 0FFFF0000h" },
          { "str":"cmp     eax, edi" },
          { "str":"jz      short loc_10001838" }
        ],
        "callees":[]
      },
{
        "tag":"label_48",
        "label":"label_48",
        "out_true":"loc_10001838",
        "out_false":"label_49",
        "last_inst":"jz",
        "instructions":[
          { "str":"test    ebx, eax" },
          { "str":"jz      short loc_10001838" }
        ],
        "callees":[]
      },
{
        "tag":"label_49",
        "label":"label_49",
        "out_true":"loc_10001898",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"not     eax" },
          { "str":"mov     dword_10003004, eax" },
          { "str":"jmp     short loc_10001898" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001838",
        "label":"loc_10001838",
        "out_true":"loc_1000187E",
        "out_false":"label_50",
        "last_inst":"jnz",
        "instructions":[
          { "str":"push    esi" },
          { "str":"lea     eax, [ebp-8]" },
          { "str":"push    eax" },
          { "str":"call    ds:GetProcAddress" },
          { "str":"mov     esi, [ebp-4]" },
          { "str":"xor     esi, [ebp-8]" },
          { "str":"call    ds:GetCurrentProcessId" },
          { "str":"xor     esi, eax" },
          { "str":"call    ds:LoadLibraryA" },
          { "str":"xor     esi, eax" },
          { "str":"call    ds:VirtualAlloc" },
          { "str":"xor     esi, eax" },
          { "str":"lea     eax, [ebp-10h]" },
          { "str":"push    eax" },
          { "str":"call    ds:QueryPerformanceCounter" },
          { "str":"mov     eax, [ebp-0Ch]" },
          { "str":"xor     eax, [ebp-10h]" },
          { "str":"xor     esi, eax" },
          { "str":"cmp     esi, edi" },
          { "str":"jnz     short loc_1000187E" }
        ],
        "callees":[
          { "tag":"ds_GetCurrentProcessId" },
          { "tag":"ds_GetProcAddress" },
          { "tag":"ds_LoadLibraryA" },
          { "tag":"ds_QueryPerformanceCounter" },
          { "tag":"ds_VirtualAlloc" }
        ]
      },
{
        "tag":"label_50",
        "label":"label_50",
        "out_true":"loc_10001889",
        "out_false":"",
        "last_inst":"jmp",
        "instructions":[
          { "str":"mov     esi, 0BB40E64Fh" },
          { "str":"jmp     short loc_10001889" }
        ],
        "callees":[]
      },
{
        "tag":"loc_1000187E",
        "label":"loc_1000187E",
        "out_true":"loc_10001889",
        "out_false":"label_51",
        "last_inst":"jnz",
        "instructions":[
          { "str":"test    ebx, esi" },
          { "str":"jnz     short loc_10001889" }
        ],
        "callees":[]
      },
{
        "tag":"label_51",
        "label":"label_51",
        "out_true":"loc_10001889",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"mov     eax, esi" },
          { "str":"shl     eax, 10h" },
          { "str":"or      esi, eax" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001889",
        "label":"loc_10001889",
        "out_true":"loc_10001898",
        "out_false":"",
        "last_inst":"",
        "instructions":[
          { "str":"mov     ___security_cookie, esi" },
          { "str":"not     esi" },
          { "str":"mov     dword_10003004, esi" },
          { "str":"pop     esi" }
        ],
        "callees":[]
      },
{
        "tag":"loc_10001898",
        "label":"loc_10001898",
        "out_true":"",
        "out_false":"",
        "last_inst":"retn",
        "instructions":[
          { "str":"pop     edi" },
          { "str":"pop     ebx" },
          { "str":"leave" },
          { "str":"retn" }
        ],
        "callees":[]
      }
    ]
  },{
    "tag":"MMTCMEncodeEX",
    "label":"MMTCMEncodeEX",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"_ebp_var_8_",
    "label":"[ebp+var_8]",
    "type":"indirect",
    "callees":[],
    "blocks":[]
  },{
    "tag":"__CppXcptFilter",
    "label":"__CppXcptFilter",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"__SEH_epilog4",
    "label":"__SEH_epilog4",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"__SEH_prolog4",
    "label":"__SEH_prolog4",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"__clean_type_info_names_internal",
    "label":"__clean_type_info_names_internal",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"__dllonexit",
    "label":"__dllonexit",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"_amsg_exit",
    "label":"_amsg_exit",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"_crt_debugger_hook",
    "label":"_crt_debugger_hook",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"_except_handler4_common",
    "label":"_except_handler4_common",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"_initterm",
    "label":"_initterm",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"_initterm_e",
    "label":"_initterm_e",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"_lock",
    "label":"_lock",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"_unlock",
    "label":"_unlock",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_GetCurrentProcess",
    "label":"ds:GetCurrentProcess",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_GetCurrentProcessId",
    "label":"ds:GetCurrentProcessId",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_GetProcAddress",
    "label":"ds:GetProcAddress",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_InterlockedExchange",
    "label":"ds:InterlockedExchange",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_IsDebuggerPresent",
    "label":"ds:IsDebuggerPresent",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_LoadLibraryA",
    "label":"ds:LoadLibraryA",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_QueryPerformanceCounter",
    "label":"ds:QueryPerformanceCounter",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_SetUnhandledExceptionFilter",
    "label":"ds:SetUnhandledExceptionFilter",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_Sleep",
    "label":"ds:Sleep",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_TerminateProcess",
    "label":"ds:TerminateProcess",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_UnhandledExceptionFilter",
    "label":"ds:UnhandledExceptionFilter",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_VirtualAlloc",
    "label":"ds:VirtualAlloc",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds__encode_pointer",
    "label":"ds:_encode_pointer",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds__encoded_null",
    "label":"ds:_encoded_null",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds__onexit",
    "label":"ds:_onexit",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"ds_free",
    "label":"ds:free",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"dword_1000335C",
    "label":"dword_1000335C",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"eax",
    "label":"eax",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"edi",
    "label":"edi",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"esi",
    "label":"esi",
    "type":"library",
    "callees":[],
    "blocks":[]
  },{
    "tag":"loc_100015A5",
    "label":"loc_100015A5",
    "type":"library",
    "callees":[],
    "blocks":[]
  }
  ]
}